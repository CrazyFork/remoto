<!doctype html>
<!-- 

	// Code generated by Remoto; DO NOT EDIT.

-->
<html>
<head>
	<title>Remoto example service</title>
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css'>
	<meta name='generator' content='remotohttpjson jquery3-client-ui'>
</head>
<body>
	<section class="hero">
		<div class="hero-body">
			<div class="container">
				<h1 class="title">
					Remoto Web UI
				</h1>
				<h2 class="subtitle">
					Using jQuery 3 client library for <code><%= def.PackageName %></code>
				</h2>
			</div>
		</div>
	</section>
	<section class='section'>
		<div class='container'>
			<div class='content'>
				<%= for (service) in def.Services { %>
				<div class='box'>
					<h2><%= service.Name %></h2>
					<p><%= service.Comment %></p>
					<div class='field'>
						<label class='label'>Endpoint</label>
						<input name='<%= camelize_down_first(service.Name) %>Endpoint' type='url' required='required' class='input' placeholder='endpoint' value='http://localhost:8080'>
					</div>
					<%= for (method) in service.Methods { %>
					<h3><%= method.Name %></h3>
					<div class='columns'>
						<div class='column'>
							<form data-action='<%= service.Name %>.<%= method.Name %>'>
								<%= for (field) in method.RequestType.Fields { %>
									<div class='field'>
										<label class='label'><%= field.Name %></label>
										<input name='<%= field.Name %>' class='input' placeholder='<%= field.Comment %>'>
									</div>
								<% } %>
								<div class='field is-grouped is-grouped-right'>
									<div class='control'>
										<button class='is-primary button'><%= service.Name %>.<%= method.Name %></button>
									</div>
								</div>
							</form>
						</div>
						<div class='column'>
							
						</div>
					</div>
				
					<% } %>
				</div>
				<% } %>
			</div>
		</div>
	</section>
	<section class='section'>
		<div class='container'>
			<p>
				<a target='remoto-ui-sidecar' href='https://github.com/machinebox/remoto'>Remoto</a> by<br />
				<a target='remoto-ui-sidecar' href='https://machinebox.io/#utm_source=remotoui&utm_campaign=remotoui'>
					<img width='150px' src='https://machinebox.io/assets/shared/static/img/machineboxlogo.svg'>
				</a>
			</p>
		</div>
	</section>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src='jquery-client.js'></script>
	<script>

		$(function(){

			<%= for (service) in def.Services { %>
			<%= for (method) in service.Methods { %>
			$('form[data-action="<%= service.Name %>.<%= method.Name %>"]').submit(function(e){
				e.preventDefault();

				// Create a service using the endpoint.
				// In production code, you would likely only do this once, with the endpoint
				// preconfigured.
				var <%= camelize_down_first(service.Name) %> = new $.remoto.<%= service.Name %>({
					endpoint: $('input[name="<%= camelize_down_first(service.Name) %>Endpoint"]').val()
				})

				var $this = $(this)
				var req = {}
				<%= for (field) in method.RequestType.Fields { %>req['<%= camelize_down_first(field.Name) %>'] = $this.find('input[name="<%= field.Name %>"]').val()
				<% } %>
				// call <%= camelize_down_first(service.Name) %>.<%= method.Name %>
				<%= camelize_down_first(service.Name) %>.<%= method.Name %>([req])
					.then(function(){  })
			})
			<% } %>
			<% } %>

		})

	</script>
</body>
</html>
